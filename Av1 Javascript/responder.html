<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responder Pergunta</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1 id="tituloPergunta">Responder Pergunta</h1>
    <h2 id="textoPergunta"></h2>
    
    <form id="formResposta">
        <div id="opcoesResposta">
            </div>
        <br>
        <input type="submit" value="Enviar Resposta">
    </form>
    
    <p id="msg"></p>
    <a href='funcionario.html'>Voltar</a>

    <script src="db.js"></script>
    <script src="auth.js"></script>
    <script>
        protegerPagina('funcionario');

        const perguntaId = sessionStorage.getItem('perguntaId');
        const tituloPergunta = document.getElementById('tituloPergunta');
        const textoPergunta = document.getElementById('textoPergunta');
        const opcoesResposta = document.getElementById('opcoesResposta');
        const formResposta = document.getElementById('formResposta');
        const msg = document.getElementById('msg');
        let respostaCerta = '';

        // Carrega a pergunta
        window.onload = function() {
            if (perguntaId === null) {
                window.location.href = 'funcionario.html';
                return;
            }

            const p = getPerguntaById(perguntaId);
            if (!p) {
                window.location.href = 'funcionario.html';
                return;
            }

            respostaCerta = p.respCerta; // Armazena a resposta certa
            tituloPergunta.textContent = `Responder Pergunta #${parseInt(perguntaId) + 1}`;
            textoPergunta.textContent = p.pergunta;

            // Verifica se é múltipla escolha (se resp1 existe)
            if (p.resp1) {
                opcoesResposta.innerHTML = `
                    <input type="radio" name="suaResp" value="${p.resp1}" required> 
                    <label>Resposta 1: ${p.resp1}</label><br><br>
                    <input type="radio" name="suaResp" value="${p.resp2}" required>
                    <label>Resposta 2: ${p.resp2}</label><br><br>
                    <input type="radio" name="suaResp" value="${p.resp3}" required>
                    <label>Resposta 3: ${p.resp3}</label><br><br>
                `;
            } else {
                // É resposta de texto
                opcoesResposta.innerHTML = `
                    Sua Resposta: <input type="text" name="suaResp" required>
                `;
            }
        };

        // Verifica a resposta
        formResposta.addEventListener('submit', function(event) {
            event.preventDefault();
            
            // Pega o valor (funciona para rádio ou texto)
            const suaResp = formResposta.elements["suaResp"].value;

            if (suaResp.trim() === respostaCerta.trim()) {
                msg.textContent = "Resposta Correta!!!";
                msg.className = 'sucesso';
            } else {
                msg.textContent = `Resposta Incorreta!!! A resposta certa é: ${respostaCerta}`;
                msg.className = 'erro';
            }
            
            // Desabilita o formulário após responder
            formResposta.style.display = 'none';
        });
    </script>
</body>
</html>